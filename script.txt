beginscript raise_and_lower_platform

	#do not run if n times have passed, whatever.
	let check be bool as host_has ["playtime fuck off"];
	if is_equal [check, false];
		fail ["playtime should be defined"];
	endif

	let time be int as host_get [int, "playtime"];
	if is_greater_than [time, 3600] then;
		return;
	endif;

	#do not run if the button is active
	let platform_active be bool as host_query [bool, "is_active", "platbutton"]
	if is_equal [ platform_active, true ];
		return;
	endif;

	#activate and disable the button
	host_do ["activate", "platbutton"];
	host_do ["disable", "platbutton"];

	#raise platform wait for it to end.
	#TODO: should this be time or absolute space? if it is time, 
	#we can have sync problems.
	host_do ["motion", "platform", 0, 24, 0, 48];
	loop;
		let platform_motionless be bool as host_query [bool, "is_motionless", "platform"];
		if is_equal [platform_motionless, true];
			break;
		endif;
		yield;
	endloop;

	#lower platform, wait for it to end
	host_do ["motion", "platform", 0, -24, 0, -48];
	loop;
		let platform_motionless be bool as host_query [bool, "is_motionless", "platform"];
		if is_equal [platform_motionless, true];
			break;
		endif;
		yield;
	endloop;

	#enable button
	host_do ["enable", "platbutton"];

endscript

